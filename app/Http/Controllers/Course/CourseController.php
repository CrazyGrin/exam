<?php

namespace App\Http\Controllers\Course;

use Illuminate\Http\Request;

use App\Http\Requests;
use App\Http\Controllers\Controller;

class CourseController extends Controller
{
    public function showCourseByNum($num){

    	$test = "<div class=\"printTable\"><table ><thead ><tr ><td>教学班</td><td>课程号-课程名</td><td>类别</td><td>教学班分类</td><td>选课状态</td><td>教师</td><td>上课时间</td><td>地点</td><td>学生名单</td><td>备注</td></tr></thead><tbody><tr ><td rowspan='1'>A13162000022040</td><td rowspan='1'>000022  -健康教育2</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>杨莉</td><td>星期5第1-2节 1-6周,8-9周</td><td>2215</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162000022040' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162050518001</td><td rowspan='1'>050518  -英语语法与写作2</td><td rowspan='1'>限选</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>郭骞</td> <td>星期2第3-4节 1-16周</td><td>4403</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162050518001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162050529001</td><td rowspan='1'>050529  -英语视听说4</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>Jeffery</td> <td>星期1第1-2节 1-16周</td><td>5305</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162050529001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162050548001</td><td rowspan='1'>050548  -综合英语4</td><td rowspan='1'>限选</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>刘义</td> <td>星期1第5-6节 1-12周,14-16周</td><td>4417</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162050548001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162070107050</td><td rowspan='1'>070107  -形势与政策</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>毛远芳</td> <td>星期1第9-10节 5-8周</td><td>3504</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162070107050' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162100201026</td><td rowspan='1'>100201  -毛泽东思想和中国特色社会主义理论体系概论</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>李俊斌</td> <td>星期3第5-7节 1-16周</td><td>3210</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162100201026' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162W13011001</td><td rowspan='1'>W13011  -Hadoop 大数据处理</td><td rowspan='1'>限选</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>徐光侠</td> <td>星期5第5-8节 1-4周</td><td>2117</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162W13011001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='2'>AS13162130504006</td><td rowspan='2'>130504  -程序设计（4）（Java平台）</td><td rowspan='2'>限选</td><td rowspan='2' align='center'>理论（含实验）</td><td rowspan='2' align='center'>正常 </td><td>肖云鹏</td> <td>星期2第5-8节 3-18周</td><td>软件工程实验室（设计）B132</td><td rowspan='2' align='center'><a href='kb_stuList.php?jxb=AS13162130504006' target=_blank>名单</a></td><td rowspan='2'></td></tr><tr><td >肖云鹏 </td><td>星期4 第5-8节1-2周,4-6周,8-16周 </td><td>通信业务软件/数字媒体实验室B111</td></tr><tr ><td rowspan='1'>R162A1045040001</td><td rowspan='1'>A1045040-数据可视化技术</td><td rowspan='1'>选修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>秦红星</td> <td>星期2第9-10节 9-12周,14-16周</td><td>2402</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=R162A1045040001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>R162A1075200005</td><td rowspan='1'>A1075200-黑客产业链之社会工程学</td><td rowspan='1'>选修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>黄永洪</td> <td>星期2第9-10节 1-3周</td><td>2409</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=R162A1075200005' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='4'>SJ13162130505008</td><td rowspan='4'>130505  -专业实习</td><td rowspan='4'>实践</td><td rowspan='4' align='center'>实验实践</td><td rowspan='4' align='center'>正常 </td><td>徐鹏</td> <td>星期1第5-8节 17周</td><td>软件工程实验室（测试）B131</td><td rowspan='4' align='center'><a href='kb_stuList.php?jxb=SJ13162130505008' target=_blank>名单</a></td><td rowspan='4'></td></tr><tr><td >徐鹏 </td><td>星期2 第9-12节17周 </td><td>软件工程实验室（测试）B131</td></tr><tr><td >徐鹏 </td><td>星期3 第5-8节17周 </td><td>软件工程实验室（测试）B131</td></tr><tr><td >徐鹏 </td><td>星期5 第5-8节17周 </td><td>软件工程实验室（测试）B131</td></tr><tr ><td rowspan='1'>SK13162100201026</td><td rowspan='1'>100201  -毛泽东思想和中国特色社会主义理论体系概论</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>实验实践</td><td rowspan='1' align='center'>正常 </td><td>李俊斌</td> <td>星期0无安排 无安排</td><td>待定</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=SK13162100201026' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>T162090113002</td><td rowspan='1'>090113  -体育(俱乐部)-网球（网球场）</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>彭仁兰</td> <td>星期1第3-4节 2-18周双周</td><td>待定</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=T162090113002' target=_blank>名单</a></td><td rowspan='1'></td></tr></tbody></table</div><div class=\"printTable\"><table ><thead ><tr ><td>教学班</td><td>课程号-课程名</td><td>类别</td><td>教学班分类</td><td>选课状态</td><td>教师</td><td>上课时间</td><td>地点</td><td>学生名单</td><td>备注</td></tr></thead><tbody><tr ><td rowspan='1'>A13162000022040</td><td rowspan='1'>000022  -健康教育2</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>杨莉</td><td>星期5第1-2节 1-6周,8-9周</td><td>2215</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162000022040' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162050518001</td><td rowspan='1'>050518  -英语语法与写作2</td><td rowspan='1'>限选</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>郭骞</td> <td>星期2第3-4节 1-16周</td><td>4403</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162050518001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162050529001</td><td rowspan='1'>050529  -英语视听说4</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>Jeffery</td> <td>星期1第1-2节 1-16周</td><td>5305</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162050529001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162050548001</td><td rowspan='1'>050548  -综合英语4</td><td rowspan='1'>限选</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>刘义</td> <td>星期1第5-6节 1-12周,14-16周</td><td>4417</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162050548001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162070107050</td><td rowspan='1'>070107  -形势与政策</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>毛远芳</td> <td>星期1第9-10节 5-8周</td><td>3504</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162070107050' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162100201026</td><td rowspan='1'>100201  -毛泽东思想和中国特色社会主义理论体系概论</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>李俊斌</td> <td>星期3第5-7节 1-16周</td><td>3210</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162100201026' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>A13162W13011001</td><td rowspan='1'>W13011  -Hadoop 大数据处理</td><td rowspan='1'>限选</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>徐光侠</td> <td>星期5第5-8节 1-4周</td><td>2117</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=A13162W13011001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='2'>AS13162130504006</td><td rowspan='2'>130504  -程序设计（4）（Java平台）</td><td rowspan='2'>限选</td><td rowspan='2' align='center'>理论（含实验）</td><td rowspan='2' align='center'>正常 </td><td>肖云鹏</td> <td>星期2第5-8节 3-18周</td><td>软件工程实验室（设计）B132</td><td rowspan='2' align='center'><a href='kb_stuList.php?jxb=AS13162130504006' target=_blank>名单</a></td><td rowspan='2'></td></tr><tr><td >肖云鹏 </td><td>星期4 第5-8节1-2周,4-6周,8-16周 </td><td>通信业务软件/数字媒体实验室B111</td></tr><tr ><td rowspan='1'>R162A1045040001</td><td rowspan='1'>A1045040-数据可视化技术</td><td rowspan='1'>选修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>秦红星</td> <td>星期2第9-10节 9-12周,14-16周</td><td>2402</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=R162A1045040001' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>R162A1075200005</td><td rowspan='1'>A1075200-黑客产业链之社会工程学</td><td rowspan='1'>选修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>黄永洪</td> <td>星期2第9-10节 1-3周</td><td>2409</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=R162A1075200005' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='4'>SJ13162130505008</td><td rowspan='4'>130505  -专业实习</td><td rowspan='4'>实践</td><td rowspan='4' align='center'>实验实践</td><td rowspan='4' align='center'>正常 </td><td>徐鹏</td> <td>星期1第5-8节 17周</td><td>软件工程实验室（测试）B131</td><td rowspan='4' align='center'><a href='kb_stuList.php?jxb=SJ13162130505008' target=_blank>名单</a></td><td rowspan='4'></td></tr><tr><td >徐鹏 </td><td>星期2 第9-12节17周 </td><td>软件工程实验室（测试）B131</td></tr><tr><td >徐鹏 </td><td>星期3 第5-8节17周 </td><td>软件工程实验室（测试）B131</td></tr><tr><td >徐鹏 </td><td>星期5 第5-8节17周 </td><td>软件工程实验室（测试）B131</td></tr><tr ><td rowspan='1'>SK13162100201026</td><td rowspan='1'>100201  -毛泽东思想和中国特色社会主义理论体系概论</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>实验实践</td><td rowspan='1' align='center'>正常 </td><td>李俊斌</td> <td>星期0无安排 无安排</td><td>待定</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=SK13162100201026' target=_blank>名单</a></td><td rowspan='1'></td></tr><tr ><td rowspan='1'>T162090113002</td><td rowspan='1'>090113  -体育(俱乐部)-网球（网球场）</td><td rowspan='1'>必修</td><td rowspan='1' align='center'>理论</td><td rowspan='1' align='center'>正常 </td><td>彭仁兰</td> <td>星期1第3-4节 2-18周双周</td><td>待定</td><td rowspan='1' align='center'><a href='kb_stuList.php?jxb=T162090113002' target=_blank>名单</a></td><td rowspan='1'></td></tr></tbody></table</div>";

    	$curl = curl_init();
		$header = array("content-type: application/x-www-form-urlencoded; charset=UTF-8");
		$UserAgent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 3.0.04506; .NET CLR 3.5.21022; .NET CLR 1.0.3705; .NET CLR 1.1.4322)';

		curl_setopt($curl, CURLOPT_URL, "http://jwzx.cqupt.edu.cn/jwzxtmp/kebiao/kb_stu.php?xh={$num}");
		curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt($curl, CURLOPT_HEADER, 0);
		curl_setopt($curl, CURLOPT_HTTPHEADER,$header);
		curl_setopt($curl, CURLOPT_USERAGENT, $UserAgent);

		$content = curl_exec($curl);//false or true
		// $json_stu = json_decode($content);//sth... or null
		curl_close($curl);

		$reSet = "/(?<=<div class=\"printTable\">).*?(?=<\/div>)/";
		$reSet_content = [];

		preg_match_all($reSet, $content, $reSet_content);

		var_dump($reSet_content);
		echo $reSet_content[0][1];
    }
}
